# zipExtractEntry behaviors for files and directories.
tempFile archive-path!
@archive-path rmf
@archive-path toPath archive!

`zip/base` @archive zipDir

tempFile entry-root!
@entry-root rmf
@entry-root toPath entry-root!
@entry-root mkdirp

# File extraction with mkdirs and overwrite
@entry-root `single/alpha.txt` / single-file!
@archive "alpha.txt" @single-file {
    overwrite: true,
    mkdirs: true
} zipExtractEntry

"zipExtractEntry file" wl
@single-file readFile wl

# skipExisting keeps prior contents
@entry-root `skip` / skip-dir!
@skip-dir mkdirp
@skip-dir `alpha.txt` / skip-file!
"ORIGINAL" @skip-file writeFile

@archive "alpha.txt" @skip-file {
    skipExisting: true,
    mkdirs: true
} zipExtractEntry

"zipExtractEntry skipExisting" wl
@skip-file readFile wl

# Directory extraction recreates subtree
@entry-root `nested` / nested-dir!
@archive "nested" @nested-dir {
    mkdirs: true
} zipExtractEntry

"zipExtractEntry nested" wl
@nested-dir `bravo.txt` / readFile wl
