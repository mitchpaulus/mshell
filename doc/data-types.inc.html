<div id="data-types-top"></div>
<p><code>msh</code> has a fixed number of built in data types</p>

<ul>
    <li><a href="#data-type-literal">Literal</a></li>
    <li><a href="#data-type-bool">Bool</a></li>
    <li><a href="#data-type-quotation">Quotation</a></li>
    <li><a href="#data-type-list">List</a></li>
    <li><a href="#data-type-string">String</a></li>
    <li><a href="#data-type-int-and-float">Integer</a></li>
    <li><a href="#data-type-int-and-float">Float</a></li>
    <li><a href="#data-type-path">Path</a></li>
    <li><a href="#data-type-dictionary">Dictionary</a></li>
    <li><a href="#data-type-datetime">Date/Time</a></li>
    <li><a href="#data-type-maybe">Maybe</a></li>
    <li><a href="#data-type-pipe">Pipe</a></li>
    <li><a href="#data-type-binary">Binary</a></li>
    <li><a href="#data-type-grid">Grid</a></li>
    <li><a href="#data-type-gridview">GridView</a></li>
    <li><a href="#data-type-gridrow">GridRow</a></li>
</ul>

<p>
The source code for all these types is in a single file at: <a href="https://github.com/mitchpaulus/mshell/blob/main/mshell/MShellObject.go" target="_blank" rel="noopener noreferrer">mshell/MShellObject.go</a>.
</p>

<h1 id="data-type-literal">Literal <a class="section-link" href="#data-type-literal" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
Since brevity is a strong design goal, like most shells, many basic tokens can be written as-is.
But unlike in most shells, we limit where the number of places literal tokens can be used.
They can only be used in list literals, because that's how commands are input.
Outside of lists, it will result in an error.
</p>

<p>
Literal tokens may contain any non-whitespace characters except the following:
</p>

<ul>
    <li><code>[ ] ( ) { } &lt; &gt; : ; ? ! @ , * &amp; | &#34; &#39; ^</code></li>
</ul>

<p>
Periods and forward/backslashes (<code>.</code>, <code>/</code>, <code>\</code>) are allowed so common path-like tokens do not need quoting.
</p>

<p>
The equals sign (<code>=</code>) is also allowed so flags like <code>--option=value</code> do not need quoting on the CLI.
</p>

<h1 id="data-type-bool">Bool <a class="section-link" href="#data-type-bool" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>Bools are represented by 
<code><span class="mshellTRUE">true</span></code>
 and 
 <code><span class="mshellFALSE">false</span></code>.</p>


<h1 id="data-type-quotation">Quotation <a class="section-link" href="#data-type-quotation" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
Quotations are blocks of code that can be executed.
They are created by wrapping code in parentheses.
They are often used in places where a lambda function (or anonymous function) would be used in other languages.
For example, a quotation is used as an argument to the <code>map</code> function.
</p>

<pre>
<code><span class="mshellLEFT_PAREN">(</span><span class="mshellINTEGER">1</span> <span class="mshellINTEGER">2</span> <span class="mshellPLUS">+</span><span class="mshellRIGHT_PAREN">)</span></code>
</pre>


<h1 id="data-type-list">List <a class="section-link" href="#data-type-list" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
Lists are created by wrapping elements in square brackets.
No commas are required between elements.
</p>

<pre>
<code><span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">1</span> <span class="mshellINTEGER">2</span> <span class="mshellINTEGER">3</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span></code>
</pre>

<p>Lists can be added together with the <code>+</code> operator. The result is a new list object.</p>

<pre>
<code><span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">1</span> <span class="mshellINTEGER">2</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">3</span> <span class="mshellINTEGER">4</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellPLUS">+</span> <span class="mshellLINECOMMENT"># [1 2 3 4]</span></code>
</pre>

<p>
Lists support indexing and slicing with colon-based indexers placed after the list.
Indexes are zero-based, and negative indexes count from the end.
</p>

<pre>
<code><span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">4</span> <span class="mshellINTEGER">3</span> <span class="mshellINTEGER">2</span> <span class="mshellINTEGER">1</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellINDEXER">:1:</span> <span class="mshellLINECOMMENT"># 3</span>
<span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">4</span> <span class="mshellINTEGER">3</span> <span class="mshellINTEGER">2</span> <span class="mshellINTEGER">1</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellINDEXER">1:3</span> <span class="mshellLINECOMMENT"># [3 2]</span>
<span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">4</span> <span class="mshellINTEGER">3</span> <span class="mshellINTEGER">2</span> <span class="mshellINTEGER">1</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellINDEXER">:3</span> <span class="mshellLINECOMMENT"># [4 3 2]</span>
<span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">4</span> <span class="mshellINTEGER">3</span> <span class="mshellINTEGER">2</span> <span class="mshellINTEGER">1</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellINDEXER">2:</span> <span class="mshellLINECOMMENT"># [2 1]</span>
<span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">4</span> <span class="mshellINTEGER">3</span> <span class="mshellINTEGER">2</span> <span class="mshellINTEGER">1</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellINDEXER">:-1:</span> <span class="mshellLINECOMMENT"># 1</span>
<span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">4</span> <span class="mshellINTEGER">3</span> <span class="mshellINTEGER">2</span> <span class="mshellINTEGER">1</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellINDEXER">:-2</span> <span class="mshellLINECOMMENT"># [4 3]</span>
<span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">4</span> <span class="mshellINTEGER">3</span> <span class="mshellINTEGER">2</span> <span class="mshellINTEGER">1</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellINDEXER">-3:</span> <span class="mshellLINECOMMENT"># [3 2 1]</span>
<span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellINTEGER">4</span> <span class="mshellINTEGER">3</span> <span class="mshellINTEGER">2</span> <span class="mshellINTEGER">1</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellINDEXER">-3:-1</span> <span class="mshellLINECOMMENT"># [3 2]</span></code>
</pre>

<p>
Slice ranges must be forward (start less than or equal to end). Reverse ranges like <code>3:1</code> are invalid; use <code>reverse</code> after slicing if needed.
</p>


<h1 id="data-type-string">String <a class="section-link" href="#data-type-string" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
<code>msh</code> has double quotes and single quotes. 
Double quoted strings have the following escape sequences:
</p>

<ul>
  <li> <code>\e</code>: Escape </li>
  <li> <code>\n</code>: Newline </li>
  <li> <code>\t</code>: Tab </li>
  <li> <code>\r</code>: Carriage return </li>
  <li> <code>\\</code>: Backslash </li>
  <li> <code>\"</code>: Double quote </li>
</ul>

<p>
Strings use the same indexing and slicing syntax as lists.
Indexing returns a one-character string, and slicing returns a substring.
Indexes are zero-based, and negative indexes count from the end.
</p>

<pre>
<code><span class="mshellSTRING">&#34;mshell&#34;</span> <span class="mshellINDEXER">:1:</span> <span class="mshellLINECOMMENT"># &#34;s&#34;</span>
<span class="mshellSTRING">&#34;mshell&#34;</span> <span class="mshellINDEXER">1:4</span> <span class="mshellLINECOMMENT"># &#34;she&#34;</span>
<span class="mshellSTRING">&#34;mshell&#34;</span> <span class="mshellINDEXER">:3</span> <span class="mshellLINECOMMENT"># &#34;msh&#34;</span>
<span class="mshellSTRING">&#34;mshell&#34;</span> <span class="mshellINDEXER">2:</span> <span class="mshellLINECOMMENT"># &#34;hell&#34;</span>
<span class="mshellSTRING">&#34;mshell&#34;</span> <span class="mshellINDEXER">:-1:</span> <span class="mshellLINECOMMENT"># &#34;l&#34;</span>
<span class="mshellSTRING">&#34;mshell&#34;</span> <span class="mshellINDEXER">:-2</span> <span class="mshellLINECOMMENT"># &#34;msh&#34;</span>
<span class="mshellSTRING">&#34;mshell&#34;</span> <span class="mshellINDEXER">-3:</span> <span class="mshellLINECOMMENT"># &#34;hell&#34;</span>
<span class="mshellSTRING">&#34;mshell&#34;</span> <span class="mshellINDEXER">-4:-1</span> <span class="mshellLINECOMMENT"># &#34;she&#34;</span></code>
</pre>

<p> If you have a backslash and it isn't followed by one of the escape characters above, <code>msh</code> will throw an error. </p>

<p>No escaping is done within single quoted strings or paths.</p>

<p> 
<code>mshell</code> is implemented in <a href="https://go.dev">Go</a>. Therefore, it's important to understand how Go thinks about strings.
<a href="https://go.dev/blog/strings">This blog post</a> explains the design of Go string handling.
In short, if you stick to UTF-8 encoded strings and data, you should have a good time.
If you have strings in other encodings, your results might have subtle differences.
</p>

<h1 id="data-type-path">Path <a class="section-link" href="#data-type-path" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>
<p> Since paths are such a common object to deal with in shell scripts, mshell has a dedicated type. </p>

<p>
Paths are created by wrapping the path in backticks. No escaping is done.
If you need to escape or use string interpolation, then use double quotes and <code>toPath</code>.
</p>

<pre>
<code><span class="mshellPATH">`path/to/file`</span>
<span class="mshellFORMATSTRING">$&#34;my/path/is/built/from/</span><span class="mshellVARRETRIEVE">{@variable}</span><span class="mshellFORMATSTRING">&#34;</span> <span class="mshellLITERAL">toPath</span></code>
</pre>

<p>
Because paths are fundamentally different than strings, many functions change their behavior on whether the input is a path or a string.
For example, for a function like <code>parseJson</code>, if the input is a path, it will read the file at that path and parse the contents as JSON.
If the input is binary data, it first decodes the bytes as UTF-8.
Otherwise, it will parse the string as JSON directly.
</p>

<p>
The other place this is important is in command input redirection.
You often want to pipe input into a command, but sometimes it's from a file, and sometimes it's from a string.
In <code>msh</code>, this choice can be made by using the appropriate type.
</p>

<pre>
<code><span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellLITERAL">wc</span> <span class="mshellLITERAL">-l</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellPATH">`myfile.txt`</span> <span class="mshellLESSTHAN">&lt;</span> <span class="mshellEXECUTE">;</span> <span class="mshellLINECOMMENT"># Counts the number of lines in myfile.txt</span>
<span class="mshellLEFT_SQUARE_BRACKET">[</span><span class="mshellLITERAL">wc</span> <span class="mshellLITERAL">-l</span><span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellSTRING">&#34;line 1\nline 2\n&#34;</span> <span class="mshellLESSTHAN">&lt;</span> <span class="mshellEXECUTE">;</span> <span class="mshellLINECOMMENT"># Counts the number of lines in the string &#34;line 1\nline 2\n&#34; (2)</span></code>
</pre>

<h1 id="data-type-dictionary">Dictionary <a class="section-link" href="#data-type-dictionary" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
mshell has the concept of dictionaries or associative arrays, but only with string keys (like <code>awk</code>).
</p>
<p>
Dictionaries can be instantiated using dictionary literals, like:
</p>

<pre>
<code><span class="mshellLEFT_CURLY">{</span> <span class="mshellSTRING">&#34;key&#34;</span><span class="mshellCOLON">:</span> <span class="mshellINTEGER">1</span> <span class="mshellRIGHT_CURLY">}</span></code>
</pre>

<p>
Be careful with some of the lexing around the colon, as it's used with indexing.
Best practice is a space between the colon and the value.
</p>

<pre>
<code><span class="mshellLEFT_CURLY">{</span> <span class="mshellSTRING">&#34;key&#34;</span><span class="mshellENDINDEXER">:1</span> <span class="mshellRIGHT_CURLY">}</span> <span class="mshellLINECOMMENT"># Bad because &#39;:1&#39; is treated as index</span></code></pre>

<h1 id="data-type-datetime">Date/Time <a class="section-link" href="#data-type-datetime" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
Date/times can be entered using a literal syntax, in ISO-8601 format.
</p>

<pre>
<code><span class="mshellLINECOMMENT"># All are valid</span>
<span class="mshellDATETIME">2023-10-01</span>
<span class="mshellDATETIME">2023-10-01T13</span>
<span class="mshellDATETIME">2023-10-01T13:01</span>
<span class="mshellDATETIME">2023-10-01T13:01:30</span></code>
</pre>


<p>
Dates can be subtracted from each other, and the result is a floating-point number of days.
</p>

<pre>
<code><span class="mshellDATETIME">2023-10-02</span> <span class="mshellDATETIME">2023-10-01</span> <span class="mshellMINUS">-</span> <span class="mshellLINECOMMENT"># 1.0</span></code>
</pre>

<h1 id="data-type-int-and-float">Float and Integer <a class="section-link" href="#data-type-int-and-float" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
mshell makes a distinction between integers and floats.
Any literal number with a decimal will be lexed as a float, otherwise it will be an integer.
</p>

<pre>
<code><span class="mshellINTEGER">1</span>   <span class="mshellLINECOMMENT"># This is an integer literal</span>
<span class="mshellFLOAT">1.0</span> <span class="mshellLINECOMMENT"># This is a float literal</span></code>
</pre>

<p>
Division for integers will result in an integer without the remainder.
</p>

<pre>
<code><span class="mshellINTEGER">5</span> <span class="mshellINTEGER">2</span> <span class="mshellLITERAL">/</span> <span class="mshellLINECOMMENT"># Integer 2, not float 2.5</span></code>
</pre>

<p>
Division is only supported for similar types, it is a runtime error to divide a float by an integer (or an integer by a float).
For the other operations, if the types are mixed, the result is a float.
</p>

<pre>
<code><span class="mshellINTEGER">2</span> <span class="mshellFLOAT">2.5</span> <span class="mshellASTERISK">*</span> <span class="mshellLINECOMMENT"># 5.0 float</span>
<span class="mshellINTEGER">3</span> <span class="mshellFLOAT">2.5</span> <span class="mshellMINUS">-</span> <span class="mshellLINECOMMENT"># 0.5 float</span>
<span class="mshellINTEGER">3</span> <span class="mshellFLOAT">2.5</span> <span class="mshellPLUS">+</span> <span class="mshellLINECOMMENT"># 5.5 float</span></code>
</pre>


<h1 id="data-type-maybe">Maybe <a class="section-link" href="#data-type-maybe" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
The <code>Maybe</code> type is a way to represent a value that may or may not exist.
It's like a better, strongly typed null value.
It's a value that can either be <code>none</code> or a <code>just[type]</code> value.
</p>

<p>
They can be instantiated using:
</p>

<pre>
<code><span class="mshellLITERAL">none</span> <span class="mshellLINECOMMENT"># None value</span>
<span class="mshellSTRING">&#34;my string&#34;</span> <span class="mshellLITERAL">just</span> <span class="mshellLINECOMMENT"># Just value of a string</span></code>
</pre>

<p>
There are several functions with a Maybe type, but perhaps the most important is to just unwrap the value and fail entirely if it is <code>none</code>.
This is done with the <code>?</code> operator.
</p>

<pre>
<code><span class="mshellSTRING">&#34;1&#34;</span> <span class="mshellLITERAL">toFloat</span><span class="mshellQUESTION">?</span> <span class="mshellLINECOMMENT"># This will result in 1.0 being on the stack (Not wrapped)</span>
<span class="mshellSTRING">&#34;bad string&#34;</span> <span class="mshellLITERAL">toFloat</span><span class="mshellQUESTION">?</span> <span class="mshellLINECOMMENT"># This will result in failure and execution will stop.</span></code>
</pre>

<h1 id="data-type-pipe">Pipe <a class="section-link" href="#data-type-pipe" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
A <code>pipe</code> is really a special list (and this type may get consumed by <code>list</code> in the future).
</p>

<p>
It's created by the <code>|</code> operator.
</p>

<pre>
<code><span class="mshellLEFT_SQUARE_BRACKET">[</span>
  <span class="mshellLEFT_SQUARE_BRACKET">[</span> <span class="mshellLITERAL">myCommand</span> <span class="mshellRIGHT_SQUARE_BRACKET">]</span>
  <span class="mshellLEFT_SQUARE_BRACKET">[</span> <span class="mshellLITERAL">wc</span> <span class="mshellLITERAL">-l</span> <span class="mshellRIGHT_SQUARE_BRACKET">]</span>
<span class="mshellRIGHT_SQUARE_BRACKET">]</span> <span class="mshellPIPE">|</span> <span class="mshellEXECUTE">;</span>  <span class="mshellLINECOMMENT"># Counting the number of lines of output from myCommand</span></code>
</pre>

<h1 id="data-type-binary">Binary <a class="section-link" href="#data-type-binary" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
Many times in shell programs you need to deal directly with binary data.
This type represents an array of bytes.
Example functions that takes binary data as input and output are <a href="functions.html#func-utf8Str"><code>utf8Str</code></a>, <a href="functions.html#func-utf8Bytes"><code>utf8Bytes</code></a>, <a href="functions.html#func-base64encode"><code>base64encode</code></a>, and <a href="functions.html#func-base64decode"><code>base64decode</code></a>.
</p>

<h1 id="data-type-grid">Grid <a class="section-link" href="#data-type-grid" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
A <code>Grid</code> is a high-performance columnar data frame type for tabular data.
It stores data column-wise for efficient operations on columns.
See the <a href="grid.html">Grid documentation</a> for full details.
</p>

<pre>
<code><span class="mshellDOUBLE_LEFT_CURLY">{{</span>
   <span class="mshellLITERAL">name</span><span class="mshellCOMMA">,</span> <span class="mshellLITERAL">age</span><span class="mshellEXECUTE">;</span>
   <span class="mshellSTRING">"Alice"</span><span class="mshellCOMMA">,</span> <span class="mshellINTEGER">30</span><span class="mshellEXECUTE">;</span>
   <span class="mshellSTRING">"Bob"</span><span class="mshellCOMMA">,</span> <span class="mshellINTEGER">25</span>
<span class="mshellDOUBLE_RIGHT_CURLY">}}</span></code>
</pre>

<h1 id="data-type-gridview">GridView <a class="section-link" href="#data-type-gridview" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
A <code>GridView</code> is a filtered view of a Grid that references the original data without copying.
It is created by the <code>gridFilter</code> operation.
Use <code>gridCompact</code> to materialize a GridView into a real Grid.
</p>

<h1 id="data-type-gridrow">GridRow <a class="section-link" href="#data-type-gridrow" aria-label="Permalink">§</a> <a class="back-to-top" href="#data-types-top">Back to top</a></h1>

<p>
A <code>GridRow</code> is a lazy reference to a single row in a Grid.
It supports dictionary-like access with <code>:colname</code> or <code>get</code>.
Use <code>toDict</code> to convert a GridRow to a dictionary.
</p>
